<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en" xmlns:z="http://www.hekkelman.com/libzeep/m2" xmlns="http://www.w3.org/1999/xhtml">

<head z:replace="~{head :: head(~{::title}, ~{::link}, ~{::script})}">
	<title z:text="|AlphaFold Filled - Model ${AF_ID}|"></title>

	<link rel="stylesheet" type="text/css" href="css/molstar.css" />

	<script z:inline="javascript">
		const AF_ID = /*[[${af_id}]]*/ null;
	</script>

	<script defer="defer" type="text/javascript" src="scripts/model.js"></script>
</head>
	
<body class="site">

	<header z:replace="header::top('model')"></header>

	<div class="container site-content">
		<h2 z:text="${title}" class="mb-4"></h2>

		<table class="table table-sm">
			<tr>
				<td>Structure file</td>
				<td><a z:href="|https://alphafill.eu/v1/aff/${af_id}|" z:text="|https://alphafill.eu/v1/aff/${af_id}|"></a></td>
			</tr>
			<tr>
				<td>Metadata</td>
				<td><a z:href="|https://alphafill.eu/v1/aff/${af_id}/json|" z:text="|https://alphafill.eu/v1/aff/${af_id}/json|"></a></td>
			</tr>
			<tr>
				<td>Original AlphaFold model</td>
				<td><a z:href="|https://alphafold.ebi.ac.uk/entry/${af_id}|" z:text="|https://alphafold.ebi.ac.uk/entry/${af_id}|" target="_BLANK"></a></td>
			</tr>
		</table>

		<div class="row mt-5">
			<div class="col" id="app"></div>

			<div class="col">

				<table class="table table-sm table-hover" id="transplant-table-by-compound">
					<thead>
						<tr>
							<th><abbr title="Name of the compound that was transplanted by AlphaFill">Compound</abbr></th>
							<th><abbr title="PDB-REDO identifier followed by chain that was used in the alignment">PDB-REDO-ID</abbr></th>
							<th><abbr title="RMSD for the overall protein alignment based on Cα atoms">Global RMSd</abbr></th>
							<th><abbr title="The ID for the struct_asym created for this transplant">Asym</abbr></th>
							<th><abbr title="RMSD of the alignment of all backbone atoms within 6Å of the compound that was transplanted by AlphaFill">Local RMSd</abbr></th>
						</tr>
					</thead>

					<tbody>
						<tr z:each="c,i: ${by_compound}" class="transplanted-row" z:with="t=${c.transplant}" z:data-asym-id="${t.asym_id}">
							<td z:if="${c.first-hit and c.first-transplant}" z:rowspan="${c.hit-count}"
								z:text="${t.analogue_id == t.compound_id ? t.compound_id : |${t.compound_id} -&gt; ${t.analogue_id}|}">
							</td>

							<td z:if="${c.first-transplant}" z:rowspan="${c.transplant-count}" z:text="|${c.pdb_id}.${c.pdb_asym_id}|"></td>

							<td z:if="${c.first-transplant}" z:rowspan="${c.transplant-count}" 
								z:classappend="${c.rmsd ge 5.0 ? 'bad-score' }">
								<span z:text="${#numbers.formatDecimal(c.rmsd, 1, 2)}"></span>
								<span z:if="${c.rmsd ge 5.0}" class="float-end"><abbr title="This RMSd score is above the confidence level">?</abbr></span>
							</td>

							<td z:text="${t.asym_id}"></td>

							<td z:classappend="${t.rmsd ge 1.0 ? 'bad-score' }">
								<span z:text="${#numbers.formatDecimal(t.rmsd, 1, 2)}"></span>
								<span z:if="${t.rmsd ge 1.0}" class="float-end"><abbr title="This RMSd score is above the confidence level">?</abbr></span>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<footer z:replace="~{footer::content}"></footer>

</body>

</html>