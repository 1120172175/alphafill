<!DOCTYPE html SYSTEM "about:legacy-compat" [
<!ENTITY mdash "&#8212;">
]>

<html lang="en" xmlns:z="http://www.hekkelman.com/libzeep/m2" xmlns="http://www.w3.org/1999/xhtml">

<head z:replace="~{head :: head(~{::title}, ~{::link}, ~{::script})}">
	<title z:text="|AlphaFold Filled - Model ${af_id}|"></title>

	<link rel="stylesheet" type="text/css" href="css/molstar.css" />

	<script z:inline="javascript">
		const AF_ID = /*[[${af_id}]]*/ null;
		const IDENTITY = /*[[${identity}]]*/ 35;
	</script>

	<script defer="defer" type="text/javascript" src="scripts/model.js"></script>
</head>

<body class="site">

	<header z:replace="header::top('model')"></header>

	<div class="container site-content">
		<h2 z:text="${af_id}"></h2>
		<h5 z:text="${title}"></h5>

		<table class="table table-sm mt-4">
			<tr>
				<td>Structure file</td>
				<td><a z:href="|https://alphafill.eu/v1/aff/${af_id}|"
						z:text="|https://alphafill.eu/v1/aff/${af_id}|"></a></td>
			</tr>
			<tr>
				<td>Metadata</td>
				<td><a z:href="|https://alphafill.eu/v1/aff/${af_id}/json|"
						z:text="|https://alphafill.eu/v1/aff/${af_id}/json|"></a></td>
			</tr>
			<tr>
				<td>Original AlphaFold model</td>
				<td><a z:href="|https://alphafold.ebi.ac.uk/entry/${af_id}|"
						z:text="|https://alphafold.ebi.ac.uk/entry/${af_id}|" target="_BLANK"></a></td>
			</tr>
		</table>

		<div class="row mt-5">
			<div class="col" id="app"></div>

			<div class="col">

				<div class="btn-group btn-group-sm" role="group" aria-label="Select identity cut-off buttons"
					style="width: 100%;">
					<input type="radio" class="btn-check" name="btnradio" id="btnradio-35" autocomplete="off" data-identity="35"
						checked="checked" z:checked="${identity == null or identity == 35}" />
					<label class="btn btn-outline-primary" for="btnradio-35">35% identity</label>

					<input type="radio" class="btn-check" name="btnradio" id="btnradio-40" autocomplete="off" data-identity="40"
						z:checked="${identity == 40}" />
					<label class="btn btn-outline-primary" for="btnradio-40">40% identity</label>

					<input type="radio" class="btn-check" name="btnradio" id="btnradio-50" autocomplete="off" data-identity="50"
						z:checked="${identity == 50}" />
					<label class="btn btn-outline-primary" for="btnradio-50">50% identity</label>

					<input type="radio" class="btn-check" name="btnradio" id="btnradio-60" autocomplete="off" data-identity="60"
						z:checked="${identity == 60}" />
					<label class="btn btn-outline-primary" for="btnradio-60">60% identity</label>

					<input type="radio" class="btn-check" name="btnradio" id="btnradio-70" autocomplete="off" data-identity="70"
						z:checked="${identity == 70}" />
					<label class="btn btn-outline-primary" for="btnradio-70">70% identity</label>
				</div>

				<table class="mt-4 table table-sm table-hover" id="transplant-table-by-compound">
					<thead>
						<tr>
							<th><abbr title="Name of the compound that was transplanted by AlphaFill">Compound</abbr>
							</th>
							<th><abbr
									title="PDB-REDO identifier followed by chain that was used in the alignment">PDB-ID</abbr>
							</th>
							<th><abbr title="RMSD for the overall protein alignment based on Cα atoms">Global
									RMSd</abbr></th>
							<th><abbr title="The ID for the struct_asym created for this transplant">Asym</abbr></th>
							<th><abbr
									title="RMSD of the alignment of all backbone atoms within 6Å of the compound that was transplanted by AlphaFill">Local
									RMSd</abbr></th>
							<th>
								<div class="form-check">
									<input class="form-check-input" checked="checked" type="checkbox" id="show-all" />
									<label class="form-check-label" for="show-all">Show</label>
								</div>
							</th>
						</tr>
					</thead>

					<tbody>
						<tr z:each="c,i: ${by_compound}" class="transplanted-row"
							role="button" z:data-asym-id="${c.asym_id}">

							<td z:if="${c.first-hit and c.first-transplant}" z:rowspan="${c.hit-count}"
								z:text="${c.analogue_id == c.compound_id ? c.compound_id : |${c.compound_id} -&gt; ${c.analogue_id}|}">
							</td>

							<td z:if="${c.first-transplant}" z:rowspan="${c.transplant-count}"
								z:text="${c.pdb_id}"></td>

							<td z:if="${c.first-transplant}" z:rowspan="${c.transplant-count}"
								z:classappend="${c.global-rmsd gt 8.56 ? 'unreliable' : c.global-rmsd gt 4.55 ? 'suspect' }">
								<span z:text="${#numbers.formatDecimal(c.global-rmsd, 1, 2)}"></span>
								<span z:if="${c.global-rmsd gt 4.55 and c.global-rmsd le 8.56}" class="float-end"><abbr
										title="This transplant is considered suspect">?</abbr></span>
								<span z:if="${c.global-rmsd gt 8.56}" class="float-end"><abbr
									title="This transplant is considered unreliable">?</abbr></span>
								</td>

							<td z:text="${c.asym_id}"></td>

							<td z:classappend="${c.local-rmsd gt 2 ? 'unreliable' : c.local-rmsd gt 1.05 ? 'suspect' }">
								<span z:text="${#numbers.formatDecimal(c.local-rmsd, 1, 2)}"></span>
								<span z:if="${c.local-rmsd gt 1.05 and c.local-rmsd le 2}" class="float-end"><abbr
										title="This transplant is considered suspect">?</abbr></span>
								<span z:if="${c.local-rmsd gt 2}" class="float-end"><abbr
									title="This transplant is considered unreliable">?</abbr></span>
							</td>

							<td>
								<div class="form-check">
									<input class="form-check-input" type="checkbox" checked="checked"
										z:data-asym-id="${c.asym_id}" />
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<footer z:replace="~{footer::content}"></footer>

</body>

</html>